# Claude Code Assistant Instructions

## é¡¹ç›®æ¦‚è¿°
è¿™æ˜¯ä¸€ä¸ªALSï¼ˆè‚Œèç¼©æ€§ä¾§ç´¢ç¡¬åŒ–ç—‡ï¼‰åŠ©æ‰‹åº”ç”¨ï¼ŒåŒ…å«å‰ç«¯Vue.jsåº”ç”¨å’Œåç«¯FastAPIæœåŠ¡ã€‚

## æ¶æ„çŠ¶æ€ï¼ˆ2024å¹´9æœˆæ›´æ–°ï¼‰
âœ… **å·²å®Œæˆé‡å¤§æ¶æ„ç®€åŒ–**ï¼š
- ä»å¤æ‚çš„ä¼šè¯è¡¨ç»“æ„è¿ç§»åˆ°åŸºäºæ–‡æ¡£çš„å­˜å‚¨ï¼ˆschema_v2.sqlï¼‰
- ç»Ÿä¸€APIç«¯ç‚¹ï¼š`/chat/conversation` å¤„ç†æ‰€æœ‰å¯¹è¯äº¤äº’
- ç®€åŒ–FSMçŠ¶æ€æœºï¼š5çŠ¶æ€æµç¨‹ï¼ˆROUTE â†’ ASK â†’ PROCESS â†’ SCORE â†’ CONTINUEï¼‰
- ç§»é™¤äº†40%çš„åç«¯å¤æ‚æ€§ï¼Œç›´æ¥è¦†å†™æºæ–‡ä»¶å®Œæˆ

## æ°¸ä¹…æ€§è¦æ±‚å’Œçº¦å®š

### ğŸ”’ ç¡¬æ€§è¦æ±‚
1. **ä¸è¦é¢å¤–å¼„ä¸€å¥—é€»è¾‘ï¼Œç›´æ¥è¦†ç›–æ—§æ–¹æ¡ˆ**
2. **å…¨éƒ¨ä»£ç å¿…é¡»æ˜¯è‹±æ–‡** - æ— ä¸­æ–‡æ³¨é‡Šæˆ–å˜é‡å
3. **æµ‹è¯•è„šæœ¬å’Œä»»ä½•æ–‡ä»¶ä½¿ç”¨å®Œæˆå¿…é¡»åˆ é™¤**
4. **ä¸è¦ä½¿ç”¨uniformæˆ–å¤æ‚æŠ½è±¡**
5. **å¼ºçƒˆåå¯¹ç¡¬ç¼–ç ** ("æˆ‘éå¸¸åå¯¾ç¡¬ç·¨ç¢¼")

### ğŸ› ï¸ æŠ€æœ¯æ ˆå’Œå·¥å…·
- **åç«¯**: FastAPI + SQLite + Document-based storage
- **å‰ç«¯**: Vue.js 3 + TypeScript + Pinia
- **æ•°æ®åº“**: schema_v2.sqlï¼ˆæ–‡æ¡£å¼å­˜å‚¨ï¼‰
- **æµ‹è¯•**: å®Œæˆåè¿è¡Œ `npm run build` å’Œ `npm run lint`

### ğŸ“ é¡¹ç›®ç»“æ„
```
backend/
  app/
    routers/
      chat_unified.py     # ç»Ÿä¸€å¯¹è¯ç«¯ç‚¹
      auth.py            # èº«ä»½éªŒè¯
      health.py          # å¥åº·æ£€æŸ¥
    services/
      storage.py         # æ–‡æ¡£å­˜å‚¨æœåŠ¡
      fsm.py            # ç®€åŒ–çŠ¶æ€æœº
      question_bank.py   # é—®é¢˜åº“
      ai_routing.py      # AIè·¯ç”±
      pnm_scoring.py     # PNMè¯„åˆ†
    data/
      schema_v2.sql      # æ–‡æ¡£æ•°æ®åº“æ¶æ„
      als.db            # ä¸»æ•°æ®åº“

frontend/
  src/
    views/
      Chat.vue          # ä¸»å¯¹è¯ç•Œé¢
      Data.vue          # æ•°æ®æ˜¾ç¤º
      Profile.vue       # ç”¨æˆ·èµ„æ–™
    stores/
      auth.ts           # èº«ä»½éªŒè¯çŠ¶æ€
      chat.ts           # å¯¹è¯çŠ¶æ€
    services/
      api.ts            # APIå®¢æˆ·ç«¯
```

### ğŸ”„ ç®€åŒ–åçš„APIæµç¨‹
1. **ç»Ÿä¸€ç«¯ç‚¹**: POST `/chat/conversation` 
   - æ¥å—: `{user_response, dimension_focus?, request_info}`
   - è¿”å›: å®Œæ•´çš„ ConversationResponse å¯¹è±¡
2. **80% å¯¹è¯æ¨¡å¼ + 20% ç»“æ„åŒ–è¯„ä¼°**
3. **è‡ªåŠ¨å¯¹è¯ç®¡ç†** - æ— éœ€å¤šä¸ªç«¯ç‚¹è°ƒç”¨

### ğŸ—„ï¸ æ•°æ®å­˜å‚¨æ¶æ„
- **conversation_documents**: ä¸»è¡¨ï¼Œæ¯ä¸ªå¯¹è¯å­˜ä¸ºJSONæ–‡æ¡£
- **conversation_scores**: ç´¢å¼•è¡¨ç”¨äºå¿«é€ŸæŸ¥è¯¢
- **ç”¨æˆ·éªŒè¯**: åˆ›å»ºå¯¹è¯å‰æ£€æŸ¥ç”¨æˆ·å­˜åœ¨

### ğŸ§ª æµ‹è¯•è¦æ±‚
åœ¨ä»»ä½•é‡å¤§æ›´æ”¹åè¿è¡Œï¼š
```bash
cd backend && python -c "from app.deps import warmup_dependencies; warmup_dependencies()"
cd frontend && npm run build
```

### ğŸ“ æ–‡æ¡£å’Œæ—¥å¿—çº¦å®š
- æ‰€æœ‰é”™è¯¯å¿…é¡»æœ‰ä¸Šä¸‹æ–‡ä¿¡æ¯
- ä½¿ç”¨è‹±æ–‡æ—¥å¿—æ¶ˆæ¯
- é‡è¦æ“ä½œéœ€è¦ç¡®è®¤æ—¥å¿—

## å½“å‰å·²çŸ¥é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### âœ… å·²ä¿®å¤çš„å…¼å®¹æ€§é—®é¢˜
1. **å¤–é”®çº¦æŸ** - åˆ›å»ºå¯¹è¯å‰éªŒè¯ç”¨æˆ·å­˜åœ¨
2. **æ¶ˆæ¯æ·»åŠ ** - æ”¯æŒå¯¹è±¡å’Œå‚æ•°ä¸¤ç§æ ¼å¼
3. **å‰ç«¯APIå…¼å®¹æ€§** - ç»Ÿä¸€ä½¿ç”¨ `/chat/conversation`
4. **å¯¹è¯å†å²** - å®æ–½é™çº§è¡Œä¸ºé¿å…å´©æºƒ

### ğŸš¨ å…³é”®æé†’
- ConversationHistoryç»„ä»¶ä½¿ç”¨é™çº§è¡Œä¸ºï¼ˆåç«¯ç«¯ç‚¹å·²ç§»é™¤ï¼‰
- Data.vueä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ï¼ˆè¯„åˆ†ç«¯ç‚¹å·²ç®€åŒ–ï¼‰
- æ‰€æœ‰æ ¸å¿ƒå¯¹è¯åŠŸèƒ½100%å…¼å®¹

## å¿«é€Ÿå‘½ä»¤å‚è€ƒ

### åç«¯æµ‹è¯•
```bash
cd backend
python -c "from app.deps import warmup_dependencies; warmup_dependencies()"
```

### å‰ç«¯æµ‹è¯•
```bash
cd als-assistant-frontend
npm run build
npm run lint  # å¦‚æœå¯ç”¨
```

### æ•°æ®åº“å¤‡ä»½
```bash
cp backend/app/data/als.db backend/app/data/als.db.backup_$(date +%Y%m%d_%H%M%S)
```

---
ğŸ“… **æœ€åæ›´æ–°**: 2024å¹´9æœˆ11æ—¥
ğŸ¯ **çŠ¶æ€**: åç«¯æ¶æ„ç®€åŒ–å®Œæˆï¼Œå‰ç«¯å…¼å®¹æ€§100%